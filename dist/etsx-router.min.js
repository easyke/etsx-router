/*!
  * etsx-router v0.0.1
  * (c) 2019 huadi
  * @license MIT
  */
var t,e;t=this,e=function(t){"use strict";var e=d,r=s,n=function(t,e){return u(s(t,e))},o=u,i=l,a="/",c=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function s(t,e){for(var r,n=[],o=0,i=0,s="",u=e&&e.delimiter||a,f=e&&e.whitelist||void 0,l=!1;null!==(r=c.exec(t));){var d=r[0],y=r[1],v=r.index;if(s+=t.slice(i,v),i=v+d.length,y)s+=y[1],l=!0;else{var m="",g=r[2],b=r[3],w=r[4],R=r[5];if(!l&&s.length){var x=s.length-1,O=s[x];(!f||f.indexOf(O)>-1)&&(m=O,s=s.slice(0,x))}s&&(n.push(s),s="",l=!1);var E="+"===R||"*"===R,k="?"===R||"*"===R,j=b||w,_=m||u;n.push({name:g||o++,prefix:m,delimiter:_,optional:k,repeat:E,pattern:j?h(j):"[^"+p(_===u?_:_+u)+"]+?"})}}return(s||i<t.length)&&n.push(s+t.substr(i)),n}function u(t){for(var e=new Array(t.length),r=0;r<t.length;r++)"object"==typeof t[r]&&(e[r]=new RegExp("^(?:"+t[r].pattern+")$"));return function(r,n){for(var o="",i=n&&n.encode||encodeURIComponent,a=0;a<t.length;a++){var c=t[a];if("string"!=typeof c){var s,u=r?r[c.name]:void 0;if(Array.isArray(u)){if(!c.repeat)throw new TypeError('Expected "'+c.name+'" to not repeat, but got array');if(0===u.length){if(c.optional)continue;throw new TypeError('Expected "'+c.name+'" to not be empty')}for(var p=0;p<u.length;p++){if(s=i(u[p],c),!e[a].test(s))throw new TypeError('Expected all "'+c.name+'" to match "'+c.pattern+'"');o+=(0===p?c.prefix:c.delimiter)+s}}else if("string"!=typeof u&&"number"!=typeof u&&"boolean"!=typeof u){if(!c.optional)throw new TypeError('Expected "'+c.name+'" to be '+(c.repeat?"an array":"a string"))}else{if(s=i(String(u),c),!e[a].test(s))throw new TypeError('Expected "'+c.name+'" to match "'+c.pattern+'", but got "'+s+'"');o+=c.prefix+s}}else o+=c}return o}}function p(t){return t.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function h(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function f(t){return t&&t.sensitive?"":"i"}function l(t,e,r){for(var n=(r=r||{}).strict,o=!1!==r.start,i=!1!==r.end,c=r.delimiter||a,s=[].concat(r.endsWith||[]).map(p).concat("$").join("|"),u=o?"^":"",h=0;h<t.length;h++){var l=t[h];if("string"==typeof l)u+=p(l);else{var d=l.repeat?"(?:"+l.pattern+")(?:"+p(l.delimiter)+"(?:"+l.pattern+"))*":l.pattern;e&&e.push(l),l.optional?l.prefix?u+="(?:"+p(l.prefix)+"("+d+"))?":u+="("+d+")?":u+=p(l.prefix)+"("+d+")"}}if(i)n||(u+="(?:"+p(c)+")?"),u+="$"===s?"$":"(?="+s+")";else{var y=t[t.length-1],v="string"==typeof y?y[y.length-1]===c:void 0===y;n||(u+="(?:"+p(c)+"(?="+s+"))?"),v||(u+="(?="+p(c)+"|"+s+")")}return new RegExp(u,f(r))}function d(t,e,r){return t instanceof RegExp?function(t,e){if(!e)return t;var r=t.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)e.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return t}(t,e):Array.isArray(t)?function(t,e,r){for(var n=[],o=0;o<t.length;o++)n.push(d(t[o],e,r).source);return new RegExp("(?:"+n.join("|")+")",f(r))}(t,e,r):function(t,e,r){return l(s(t,r),e,r)}(t,e,r)}function y(t){return Object.prototype.toString.call(t).indexOf("Error")>-1}function v(t,e,r){var n=t.charAt(0);if("/"===n)return t;if("?"===n||"#"===n)return e+t;var o=e.split("/");return r&&o[o.length-1]||o.pop(),t.replace(/^\//,"").split("/").forEach(function(t){".."===t?o.pop():"."!==t&&o.push(t)}),""!==o[0]&&o.unshift(""),o.join("/")}function m(t){return t.replace(/\/\//g,"/")}e.parse=r,e.compile=n,e.tokensToFunction=o,e.tokensToRegExp=i;var g=/[!'()*]/g,b=function(t){return"%"+t.charCodeAt(0).toString(16)},w=/%2C/g,R=function(t){return encodeURIComponent(t).replace(g,b).replace(w,",")},x=decodeURIComponent;function O(t){var e={};return(t=t.trim().replace(/^(\?|#|&)/,""))?(t.split("&").forEach(function(t){var r=t.replace(/\+/g," ").split("="),n=x(r.shift()||""),o=r.length>0?x(r.join("=")):null;void 0===e[n]?e[n]=o:Array.isArray(e[n])?e[n].push(o):e[n]=[e[n],o]}),e):e}function E(t){var e=t?Object.keys(t).map(function(e){var r=t[e];if(void 0===r)return"";if(null===r)return R(e);if(Array.isArray(r)){var n=[];return r.forEach(function(t){void 0!==t&&(null===t?n.push(R(e)):n.push(R(e)+"="+R(t)))}),n.join("&")}return R(e)+"="+R(r)}).filter(function(t){return t.length>0}).join("&"):null;return e?"?"+e:""}var k=/\/?$/;function j(t,e,r,n){var o=n&&n.options.stringifyQuery,i=e.query||{};try{i=_(i)}catch(t){}var a={name:e.name||t&&t.name,meta:t&&t.meta||{},path:e.path||"/",hash:e.hash||"",query:i,params:e.params||{},fullPath:C(e,o),matched:t?A(t):[]};return r&&(a.redirectedFrom=C(r,o)),Object.freeze(a)}function _(t){if(Array.isArray(t))return t.map(_);if(t&&"object"==typeof t){var e={};return Object.keys(t).forEach(function(r){e[r]=_(t[r])}),e}return t}var T=j(void 0,{path:"/"});function A(t){for(var e=[];t;)e.unshift(t),t=t.parent;return e}function C(t,e){var r=t.path,n=t.query;void 0===n&&(n={});var o=t.hash;return void 0===o&&(o=""),(r||"/")+(e||E)(n)+o}function L(t,e){return e===T?t===e:!!e&&(t.path&&e.path?t.path.replace(k,"")===e.path.replace(k,"")&&t.hash===e.hash&&M(t.query,e.query):!(!t.name||!e.name)&&(t.name===e.name&&t.hash===e.hash&&M(t.query,e.query)&&M(t.params,e.params)))}function M(t,e){if(void 0===t&&(t={}),void 0===e&&(e={}),!t||!e)return t===e;var r=Object.keys(t),n=Object.keys(e);return r.length===n.length&&r.every(function(r){var n=t[r],o=e[r];return"object"==typeof n&&"object"==typeof o?M(n,o):String(n)===String(o)})}var U=Object.create(null);function q(t,r,n){r=r||{};try{var o=U[t]||(U[t]=e.compile(t));return r.pathMatch&&(r[0]=r.pathMatch),o(r,{pretty:!0})}catch(t){return""}finally{delete r[0]}}function P(t,e){return e&&Object.keys(e).forEach(function(r){t[r]=e[r]}),t}function S(t,e,r,n){var o="string"==typeof t?{path:t}:t;if(o._normalized)return o;if(o.name)return P({},t);if(!o.path&&o.params&&e){(o=P({},o))._normalized=!0;var i=P(P({},e.params),o.params);if(e.name)o.name=e.name,o.params=i;else if(e.matched.length){var a=e.matched[e.matched.length-1].path;o.path=q(a,i,e.path)}return o}var c=function(t){var e="",r="",n=t.indexOf("#");n>=0&&(e=t.slice(n),t=t.slice(0,n));var o=t.indexOf("?");return o>=0&&(r=t.slice(o+1),t=t.slice(0,o)),{path:t,query:r,hash:e}}(o.path||""),s=e&&e.path||"/",u=c.path?v(c.path,s,r||o.append):s,p=function(t,e,r){void 0===e&&(e={});var n,o=r||O;try{n=o(t||"")}catch(t){n={}}return Object.keys(e).forEach(function(t){n[t]=e[t]}),n}(c.query,o.query,n&&n.options.parseQuery),h=o.hash||c.hash;return h&&"#"!==h.charAt(0)&&(h="#"+h),{_normalized:!0,path:u,query:p,hash:h}}function F(t,e){return new $(t,e)}var $=function(t,e){this.nameMap=Object.create(null),this.pathMap=Object.create(null),this.pathList=[],this.router=e,this.addRoutes(t),this.match=this.match.bind(this),this.addRoutes=this.addRoutes.bind(this)};function H(t,e,r){var n=e.match(t.regex);if(!n)return!1;if(!r)return!0;for(var o=1,i=n.length;o<i;++o){var a=t.keys[o-1],c="string"==typeof n[o]?decodeURIComponent(n[o]):n[o];a&&(r[a.name||"pathMatch"]=c)}return!0}$.prototype.addRoutes=function(t){var e=this;t.forEach(function(t){return e.addRouteRecord(t)}),this.wildcardToEnd()},$.prototype.match=function(t,e,r){var n=S(t,e,!1,this.router),o=n.name;if(o){var i=this.nameMap[o];if(!i)return this._createRoute(void 0,n);var a=i.keys.filter(function(t){return!t.optional}).map(function(t){return t.name});if("object"!=typeof n.params&&(n.params={}),e&&"object"==typeof e.params)for(var c in e.params)!(c in n.params)&&a.indexOf(c)>-1&&(n.params[c]=e.params[c]);if(i)return n.path=q(i.path,n.params),this._createRoute(i,n,r)}else if(n.path){n.params={};for(var s=0;s<this.pathList.length;s++){var u=this.pathList[s],p=this.pathMap[u];if(H(p,n.path,n.params))return this._createRoute(p,n,r)}}return this._createRoute(void 0,n)},$.prototype._createRoute=function(t,e,r){return t&&t.redirect?this.redirect(t,r||e):t&&t.matchAs?this.alias(t,e,t.matchAs):j(t,e,r,this.router)},$.prototype.redirect=function(t,e){var r=t.redirect,n="function"==typeof r?r(j(t,e,void 0,this.router)):r;if("string"==typeof n&&(n={path:n}),!n||"object"!=typeof n)return this._createRoute(void 0,e);var o=n,i=o.name,a=o.path,c=e.query,s=e.hash,u=e.params;if(c=o.hasOwnProperty("query")?o.query:c,s=o.hasOwnProperty("hash")?o.hash:s,u=o.hasOwnProperty("params")?o.params:u,i){this.nameMap[i];return this.match({_normalized:!0,name:i,query:c,hash:s,params:u},void 0,e)}if(a){var p=function(t,e){return v(t,e.parent?e.parent.path:"/",!0)}(a,t),h=q(p,u);return this.match({_normalized:!0,path:h,query:c,hash:s},void 0,e)}return this._createRoute(void 0,e)},$.prototype.alias=function(t,e,r){var n=q(r,e.params),o=this.match({_normalized:!0,path:n});if(o){var i=o.matched,a=i[i.length-1];return e.params=o.params,this._createRoute(a,e)}return this._createRoute(void 0,e)},$.prototype.addRouteRecord=function(t,r,n){var o=this,i=t.path,a=t.name,c=t.pathToRegexpOptions||{},s=function(t,e,r){return r||(t=t.replace(/\/$/,"")),"/"===t[0]?t:null==e?t:m(e.path+"/"+t)}(i,r,c.strict);"boolean"==typeof t.caseSensitive&&(c.sensitive=t.caseSensitive);var u,p=function(t,r){var n=[],o=e(t,n,r);return{keys:n,regex:o}}(s,c),h=p.keys,f=p.regex;if("object"==typeof t.components)u=t.components;else if(t.component&&"function"==typeof t.component)u={default:t.component};else{if("object"!=typeof t.component)throw new Error("component or components must is class or object");u=t.component}var l={};Object.keys(u).forEach(function(e){"boolean"==typeof t.async?l[e]=t.async:"object"==typeof t.async?l[e]=t.async[e]||!1:l[e]=!1});var d={path:s,keys:h,regex:f,components:u,instances:{},name:a,parent:r,matchAs:n,redirect:t.redirect,beforeEnter:t.beforeEnter,meta:t.meta||{},props:null==t.props?{}:t.components?t.props:{default:t.props},async:l};(t.children&&t.children.forEach(function(t){var e=n?m(n+"/"+t.path):void 0;o.addRouteRecord(t,d,e)}),void 0!==t.alias)&&(Array.isArray(t.alias)?t.alias:[t.alias]).forEach(function(e){var n={path:e,children:t.children,async:t.async};o.addRouteRecord(n,r,d.path||"/")});this.pathMap[d.path]||(this.pathList.push(d.path),this.pathMap[d.path]=d),a&&(this.nameMap[a]||(this.nameMap[a]=d))},$.prototype.wildcardToEnd=function(){for(var t=0,e=this.pathList.length;t<e;t++)"*"===this.pathList[t]&&(this.pathList.push(this.pathList.splice(t,1)[0]),e--,t--)};var W="undefined"!=typeof window,z=Object.create(null);function B(){window.history.replaceState({key:tt()},"",window.location.href.replace(window.location.origin,"")),window.addEventListener("popstate",function(t){var e;N(),t.state&&t.state.key&&(e=t.state.key,J=e)})}function I(t,e,r,n){if(t.app){var o=t.options.scrollBehavior;o&&t.app.$nextTick(function(){var i=function(){var t=tt();if(t)return z[t]}(),a=o.call(t,e,r,n?i:void 0);a&&("function"==typeof a.then?a.then(function(t){Q(t,i)}).catch(function(t){}):Q(a,i))})}}function N(){var t=tt();t&&(z[t]={x:window.pageXOffset,y:window.pageYOffset})}function D(t){return V(t.x)||V(t.y)}function K(t){return{x:V(t.x)?t.x:window.pageXOffset,y:V(t.y)?t.y:window.pageYOffset}}function V(t){return"number"==typeof t}function Q(t,e){var r,n="object"==typeof t;if(n&&"string"==typeof t.selector){var o=document.querySelector(t.selector);if(o){var i=t.offset&&"object"==typeof t.offset?t.offset:{};e=function(t,e){var r=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{x:n.left-r.left-e.x,y:n.top-r.top-e.y}}(o,i={x:V((r=i).x)?r.x:0,y:V(r.y)?r.y:0})}else D(t)&&(e=K(t))}else n&&D(t)&&(e=K(t));e&&window.scrollTo(e.x,e.y)}var X,Y=W&&((-1===(X=window.navigator.userAgent).indexOf("Android 2.")&&-1===X.indexOf("Android 4.0")||-1===X.indexOf("Mobile Safari")||-1!==X.indexOf("Chrome")||-1!==X.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history),G=W&&window.performance&&window.performance.now?window.performance:Date,J=Z();function Z(){return G.now().toFixed(3)}function tt(){return J}function et(t,e){N();var r=window.history;try{e?r.replaceState({key:J},"",t):(J=Z(),r.pushState({key:J},"",t))}catch(r){window.location[e?"replace":"assign"](t||"")}}function rt(t){et(t,!0)}function nt(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);return o}function ot(t,e){var r=e.Component,n=e.createElement,o=e.cloneElement,i=e.PropTypes;function a(){return r.apply(this,arguments)||this}return a.prototype=Object.create(r.prototype),a.prototype.constructor=a,a.__proto__=r,a.prototype.render=function(){var e=this.props,r=e.tag,i=e.href,a=void 0===i?"/":i,c=e.to,s=void 0===c?a:c,u=e.event,p=void 0===u?[]:u,h=e.children,f=nt(e,["tag","href","to","event","children"]),l=t.currentRoute,d=t.resolve(s,l,f.append),y=d.location,v=d.route,m=d.href,g={},b=t.options.linkActiveClass,w=t.options.linkExactActiveClass,R=null==b?"router-link-active":b,x=null==w?"router-link-exact-active":w,O=null==f.activeClass?R:f.activeClass,E=null==f.exactActiveClass?x:f.exactActiveClass,_=y.path?j(null,y,null,t):v;g[E]=L(l,_),g[O]=f.exact?g[E]:function(t,e){return 0===t.path.replace(k,"/").indexOf(e.path.replace(k,"/"))&&(!e.hash||t.hash===e.hash)&&function(t,e){for(var r in e)if(!(r in t))return!1;return!0}(t.query,e.query)}(l,_);var T=function(e){it(e)&&(f.replace?t.replace(y):t.push(y))};f.className=Object.keys(g).filter(function(t){return g[t]}).join(" "),f.className||delete f.className;var A={onClick:it};Array.isArray(p)?p.forEach(function(t){A[t]=T}):A[p]=T,f.href=m;var C=h;if("a"===r)Object.assign(f,A),f.href=m;else{var M=function t(e,r,n,o){void 0===o&&(o=!1);if(!o&&e)if(Array.isArray(e))e=e.map(function(e){var i=t(e,r,n,o);return o=i.isFinded,i.children});else if("a"===e.type)e=n(e),o=!0;else if(e.props&&e.props.children){var i=e.props,a=i.children,c=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&-1===e.indexOf(n)&&(r[n]=t[n]);return r}(i,["children"]),s=c,u=t(a,r,n,o);r?e=r(e,s,u.children):e.children=u.children,o=u.isFinded}return{isFinded:o,children:e}}(h,o,function(t){if(o){var e=t.props,r=e.children,n=nt(e,["children"]);return o(t,Object.assign(n,A,{href:m}),[r])}return Object.assign(t.props,A,{href:m}),t});C=M.children,M.isFinded||Object.assign(f,A)}return n(r,f,C)},Object.assign(a,{defaultProps:{tag:"a",event:"onClick"},propTypes:{to:i.oneOfType([i.string.isRequired,i.object.isRequired]),tag:i.string,exact:i.bool,append:i.bool,replace:i.bool,activeClass:i.string,exactActiveClass:i.string,event:i.oneOfType([i.string,i.arrayOf(i.string)])}}),a}function it(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||t.defaultPrevented||void 0!==t.button&&0!==t.button)){if(t.currentTarget&&t.currentTarget.getAttribute){var e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function at(t,e){var r=e.Component,n=e.createElement,o=e.PropTypes;function i(){for(var e,n=arguments,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=n[a];return(e=r.call.apply(r,[this].concat(i))||this).offForceUpdate=t.afterEach(function(){return e.forceUpdate&&e.forceUpdate()}),e}i.prototype=Object.create(r.prototype),i.prototype.constructor=i,i.__proto__=r;var a=i.prototype;return a.render=function(){var e=this._routerViewCache||(this._routerViewCache={}),r=this.props,o=r.name,i=r.children,a=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);return o}(r,["name","children"]),c=t.currentRoute;a.route=c,a.router=t;var s=c.matched[0];if(!s)return e[o]=null,n("div",a,"\u6ca1\u6709");var u=e[o]=function(t){function e(){return t.apply(this,arguments)||this}e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t;var r=e.prototype;return r.componentWillMount=function(){if(s.instances[o]=this,t.prototype.componentWillMount)return t.prototype.componentWillMount.call(this)},r.componentWillUnmount=function(){if(s.instances[o]===this&&(s.instances[o]=void 0),t.prototype.componentWillUnmount)return t.prototype.componentWillUnmount.call(this)},e}(s.components[o]),p=function(t,e){switch(typeof e){case"undefined":return;case"object":return e;case"function":return e(t);case"boolean":return e?t.params:void 0}}(c,s.props&&s.props[o]);return p&&Object.assign(a,p),n(u,a,i)},a.componentWillUnmount=function(){this.offForceUpdate&&(this.offForceUpdate(),this.offForceUpdate=void 0)},Object.assign(i,{defaultProps:{name:"default"},propTypes:{name:o.string}}),i}var ct=function(t,e,r){var n=function(o){o>=t.length?r():t[o]?e(t[o],function(){n(o+1)}):n(o+1)};n(0)};function st(t){return function(e,r,n){var o=!1,i=0,a=null;ut(t,function(t,e,r,c){if("function"==typeof t&&!0===r.async[c]){o=!0,i++;var s,u=ft(function(t){var e;((e=t).__esModule||ht&&"Module"===e[Symbol.toStringTag])&&(t=t.default),r.async[c]=!1,r.components[c]=t,--i<=0&&n()}),p=ft(function(t){var e="Failed to resolve async component "+c+": "+t;a||(a=y(t)?t:new Error(e),n(a))});try{s=t(u,p)}catch(t){p(t)}if(s)if("function"==typeof s.then)s.then(u,p);else{var h=s.component;h&&"function"==typeof h.then&&h.then(u,p)}}}),o||n()}}function ut(t,e){return pt(t.map(function(t){return Object.keys(t.components).map(function(r){return e(t.components[r],t.instances[r],t,r)})}))}function pt(t){return Array.prototype.concat.apply([],t)}var ht="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;function ft(t){var e=!1;return function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];if(!e)return e=!0,t.apply(this,r)}}var lt=function(t,e){this.router=t,this.base=function(t){if(!t)if(W){var e=document.querySelector("base");t=(t=e&&e.getAttribute("href")||"/").replace(/^https?:\/\/[^\/]+/,"")}else t="/";"/"!==t.charAt(0)&&(t="/"+t);return t.replace(/\/$/,"")}(e),this.router.currentRoute=T,this.pending=void 0,this.ready=!1,this.readyCbs=[],this.readyErrorCbs=[],this.errorCbs=[],this.cb=function(){}};function dt(t,e,r,n){var o=ut(t,function(t,n,o,i){var a=t.prototype&&t.prototype[e];if(a)return r(a,n,o,i)});return pt(n?o.reverse():o)}function yt(t,e){if(e)return t.bind(e)}lt.prototype.init=function(){},lt.prototype.listen=function(t){this.cb=t},lt.prototype.onReady=function(t,e){this.ready?t():(this.readyCbs.push(t),e&&this.readyErrorCbs.push(e))},lt.prototype.onError=function(t){this.errorCbs.push(t)},lt.prototype.transitionTo=function(t,e,r){var n=this,o=this.router.match(t,this.router.currentRoute);this.confirmTransition(o,function(){n.updateRoute(o),"function"==typeof e&&e(o),n.ensureURL(),n.ready||(n.ready=!0,n.readyCbs.forEach(function(t){t(o)}))},function(t){r&&r(t),t&&!n.ready&&(n.ready=!0,n.readyErrorCbs.forEach(function(e){e(t)}))})},lt.prototype.confirmTransition=function(t,e,r){var n=this,o=this.router.currentRoute,i=function(t){t&&y(t)&&(n.errorCbs.length?n.errorCbs.forEach(function(e){e(t)}):console&&console.error(t)),"function"==typeof r&&r(t)};if(L(t,o)&&t.matched.length===o.matched.length)return this.ensureURL(),i();var a=function(t,e){var r,n=Math.max(t.length,e.length);for(r=0;r<n&&t[r]===e[r];r++);return{updated:e.slice(0,r),activated:e.slice(r),deactivated:t.slice(r)}}(this.router.currentRoute.matched,t.matched),c=a.updated,s=a.deactivated,u=a.activated,p=[].concat(function(t){return dt(t,"beforeRouteLeave",yt,!0)}(s),this.router.beforeHooks,function(t){return dt(t,"beforeRouteUpdate",yt)}(c),u.map(function(t){return t.beforeEnter}),st(u));this.pending=t;var h=function(e,r){if(n.pending!==t)return i();try{e(t,o,function(t){!1===t||y(t)?(n.ensureURL(!0),i(t)):"string"==typeof t||"object"==typeof t&&("string"==typeof t.path||"string"==typeof t.name)?(i(),"object"==typeof t&&t.replace?n.replace(t):n.push(t)):r(t)})}catch(t){i(t)}};ct(p,h,function(){var r=[],o=function(t,e,r){return dt(t,"beforeRouteEnter",function(t,n,o,i){return function(t,e,r,n,o){return function(i,a,c){return t(i,a,function(t){c(t),"function"==typeof t&&n.push(function(){!function t(e,r,n,o){r[n]&&!r[n]._isBeingDestroyed?e(r[n]):o()&&setTimeout(function(){t(e,r,n,o)},16)}(t,e.instances,r,o)})})}}(t,o,i,e,r)})}(u,r,function(){return n.router.currentRoute===t}).concat(n.router.resolveHooks);ct(o,h,function(){if(n.pending!==t)return i();n.pending=void 0,e(t),n.router.app&&n.router.app.$nextTick(function(){r.forEach(function(t){t()})})})})},lt.prototype.updateRoute=function(t){var e=this.router.currentRoute;this.router.currentRoute=t,this.cb&&this.cb(t),this.router.afterHooks.forEach(function(r){return r&&r(t,e)})};var vt=function(t){function e(e,r){var n=this;t.call(this,e,r);var o=e.options.scrollBehavior,i=Y&&o;i&&B();var a=mt(this.base);window.addEventListener("popstate",function(t){var r=n.router.currentRoute,o=mt(n.base);n.router.currentRoute===T&&o===a||n.transitionTo(o,function(t){i&&I(e,t,r,!0)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.init=function(){this.transitionTo(this.getCurrentLocation())},e.prototype.go=function(t){window.history.go(t)},e.prototype.push=function(t,e,r){var n=this,o=this.router.currentRoute;this.transitionTo(t,function(t){et(m(n.base+t.fullPath)),I(n.router,t,o,!1),"function"==typeof e&&e(t)},r)},e.prototype.replace=function(t,e,r){var n=this,o=this.router.currentRoute;this.transitionTo(t,function(t){rt(m(n.base+t.fullPath)),I(n.router,t,o,!1),"function"==typeof e&&e(t)},r)},e.prototype.ensureURL=function(t){if(mt(this.base)!==this.router.currentRoute.fullPath){var e=m(this.base+this.router.currentRoute.fullPath);t?et(e):rt(e)}},e.prototype.getCurrentLocation=function(){return mt(this.base)},e}(lt);function mt(t){var e=decodeURI(window.location.pathname);return t&&0===e.indexOf(t)&&(e=e.slice(t.length)),(e||"/")+window.location.search+window.location.hash}var gt=function(t){function e(e,r,n){void 0===n&&(n=!1),t.call(this,e,r),n&&function(t){var e=mt(t);if(!/^\/#/.test(e))return window.location.replace(m(t+"/#"+e)),!0}(this.base)||bt()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.init=function(){var t=this,e=function(){t.setupListeners()};this.transitionTo(this.getCurrentLocation(),e,e)},e.prototype.setupListeners=function(){var t=this,e=this.router.options.scrollBehavior,r=Y&&e;r&&B(),window.addEventListener(Y?"popstate":"hashchange",function(){var e=t.router.currentRoute;bt()&&t.transitionTo(wt(),function(n){r&&I(t.router,n,e,!0),Y||Ot(n.fullPath)})})},e.prototype.push=function(t,e,r){var n=this,o=this.router.currentRoute;this.transitionTo(t,function(t){xt(t.fullPath),I(n.router,t,o,!1),"function"==typeof e&&e(t)},r)},e.prototype.replace=function(t,e,r){var n=this,o=this.router.currentRoute;this.transitionTo(t,function(t){Ot(t.fullPath),I(n.router,t,o,!1),"function"==typeof e&&e(t)},r)},e.prototype.go=function(t){window.history.go(t)},e.prototype.ensureURL=function(t){var e=this.router.currentRoute.fullPath;wt()!==e&&(t?xt(e):Ot(e))},e.prototype.getCurrentLocation=function(){return wt()},e}(lt);function bt(){var t=wt();return"/"===t.charAt(0)||(Ot("/"+t),!1)}function wt(){var t=window.location.href,e=t.indexOf("#");return-1===e?"":decodeURI(t.slice(e+1))}function Rt(t){var e=window.location.href,r=e.indexOf("#");return(r>=0?e.slice(0,r):e)+"#"+t}function xt(t){Y?et(Rt(t)):window.location.hash=t}function Ot(t){Y?rt(Rt(t)):window.location.replace(Rt(t))}var Et=function(t){function e(e,r){t.call(this,e,r),this.stack=[],this.index=-1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e,r){var n=this;this.transitionTo(t,function(t){n.stack=n.stack.slice(0,n.index+1).concat(t),n.index++,"function"==typeof e&&e(t)},r)},e.prototype.replace=function(t,e,r){var n=this;this.transitionTo(t,function(t){n.stack=n.stack.slice(0,n.index).concat(t),"function"==typeof e&&e(t)},r)},e.prototype.go=function(t){var e=this,r=this.index+t;if(!(r<0||r>=this.stack.length)){var n=this.stack[r];this.confirmTransition(n,function(){e.index=r,e.updateRoute(n)})}},e.prototype.getCurrentLocation=function(){var t=this.stack[this.stack.length-1];return t?t.fullPath:"/"},e.prototype.ensureURL=function(){},e}(lt),kt=function(t){var e,r=this;switch(this.options=t||{},this.beforeHooks=[],this.resolveHooks=[],this.afterHooks=[],this.currentRoute=T,"function"==typeof this.options.match?this.match=this.options.match:!1!==this.options.routes&&(this.matcher=F(this.options.routes||[],this)),this.getLink=function(t){return ot(r,t)},this.getView=function(t){return at(r,t)},this.fallback="history"===this.options.mode&&!Y&&!1!==this.options.fallback,this.options.mode?e=this.options.mode:W&&(e=this.options.mode||"history",this.fallback&&(e="hash")),W||(e="abstract"),this.mode=e||"abstract",this.mode){case"history":this.history=new vt(this,this.options.base);break;case"hash":this.history=new gt(this,this.options.base,this.fallback);break;case"abstract":this.history=new Et(this,this.options.base);break;default:this.history=new Et(this,this.options.base)}};function jt(t,e){return Array.isArray(t)?(t.push(e),function(){var r=t.indexOf(e);r>-1&&t.splice(r,1)}):function(){}}kt.prototype.withRouter=function(){},kt.prototype.init=function(){"function"==typeof this.history.init&&this.history.init()},kt.prototype.beforeEach=function(t){return jt(this.beforeHooks,t)},kt.prototype.beforeResolve=function(t){return jt(this.resolveHooks,t)},kt.prototype.afterEach=function(t){return jt(this.afterHooks,t)},kt.prototype.onReady=function(t,e){this.history.onReady(t,e)},kt.prototype.onError=function(t){this.history.onError(t)},kt.prototype.push=function(t,e,r){this.history.push(t,e,r)},kt.prototype.replace=function(t,e,r){this.history.replace(t,e,r)},kt.prototype.go=function(t){this.history.go(t)},kt.prototype.back=function(){this.go(-1)},kt.prototype.forward=function(){this.go(1)},kt.prototype.getMatchedComponents=function(t){var e=t?t.matched?t:this.resolve(t).route:this.currentRoute;return e?[].concat.apply([],e.matched.map(function(t){return Object.keys(t.components).map(function(e){return t.components[e]})})):[]},kt.prototype.resolve=function(t,e,r){var n=S(t,e=e||this.currentRoute,r,this),o=this.match(n,e),i=o.redirectedFrom||o.fullPath;return{location:n,route:o,href:function(t,e,r){var n="hash"===r?"#"+e:e;return t?m(t+"/"+n):n}(this.history.base,i,this.mode),normalizedTo:n,resolved:o}},kt.prototype.match=function(t,e,r){if(!this.matcher)throw new Error("No matcher instance");return this.matcher.match(t,e,r)},kt.prototype.addRoutes=function(t){if(!this.matcher)throw new Error("No matcher instance");this.matcher.addRoutes(t),this.currentRoute!==T&&this.history.transitionTo(this.history.getCurrentLocation())},t.createMatcher=F,t.Matcher=$,t.Router=kt,t.default=kt,t.getRouter=function(t){return void 0===t&&(t={}),new kt(t)},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.EtsxRouter={});