/*!
  * etsx-router v0.0.1
  * (c) 2019 huadi
  * @license MIT
  */
var t=l,e=a,n=function(t,e){return c(a(t,e))},r=c,o=f,i="/",s=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function a(t,e){for(var n,r=[],o=0,a=0,c="",p=e&&e.delimiter||i,f=e&&e.whitelist||void 0,l=!1;null!==(n=s.exec(t));){var d=n[0],y=n[1],m=n.index;if(c+=t.slice(a,m),a=m+d.length,y)c+=y[1],l=!0;else{var g="",b=n[2],v=n[3],w=n[4],R=n[5];if(!l&&c.length){var x=c.length-1,k=c[x];(!f||f.indexOf(k)>-1)&&(g=k,c=c.slice(0,x))}c&&(r.push(c),c="",l=!1);var E="+"===R||"*"===R,O="?"===R||"*"===R,j=v||w,T=g||p;r.push({name:b||o++,prefix:g,delimiter:T,optional:O,repeat:E,pattern:j?u(j):"[^"+h(T===p?T:T+p)+"]+?"})}}return(c||a<t.length)&&r.push(c+t.substr(a)),r}function c(t){for(var e=new Array(t.length),n=0;n<t.length;n++)"object"==typeof t[n]&&(e[n]=new RegExp("^(?:"+t[n].pattern+")$"));return function(n,r){for(var o="",i=r&&r.encode||encodeURIComponent,s=0;s<t.length;s++){var a=t[s];if("string"!=typeof a){var c,h=n?n[a.name]:void 0;if(Array.isArray(h)){if(!a.repeat)throw new TypeError('Expected "'+a.name+'" to not repeat, but got array');if(0===h.length){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to not be empty')}for(var u=0;u<h.length;u++){if(c=i(h[u],a),!e[s].test(c))throw new TypeError('Expected all "'+a.name+'" to match "'+a.pattern+'"');o+=(0===u?a.prefix:a.delimiter)+c}}else if("string"!=typeof h&&"number"!=typeof h&&"boolean"!=typeof h){if(!a.optional)throw new TypeError('Expected "'+a.name+'" to be '+(a.repeat?"an array":"a string"))}else{if(c=i(String(h),a),!e[s].test(c))throw new TypeError('Expected "'+a.name+'" to match "'+a.pattern+'", but got "'+c+'"');o+=a.prefix+c}}else o+=a}return o}}function h(t){return t.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function u(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function p(t){return t&&t.sensitive?"":"i"}function f(t,e,n){for(var r=(n=n||{}).strict,o=!1!==n.start,s=!1!==n.end,a=n.delimiter||i,c=[].concat(n.endsWith||[]).map(h).concat("$").join("|"),u=o?"^":"",f=0;f<t.length;f++){var l=t[f];if("string"==typeof l)u+=h(l);else{var d=l.repeat?"(?:"+l.pattern+")(?:"+h(l.delimiter)+"(?:"+l.pattern+"))*":l.pattern;e&&e.push(l),l.optional?l.prefix?u+="(?:"+h(l.prefix)+"("+d+"))?":u+="("+d+")?":u+=h(l.prefix)+"("+d+")"}}if(s)r||(u+="(?:"+h(a)+")?"),u+="$"===c?"$":"(?="+c+")";else{var y=t[t.length-1],m="string"==typeof y?y[y.length-1]===a:void 0===y;r||(u+="(?:"+h(a)+"(?="+c+"))?"),m||(u+="(?="+h(a)+"|"+c+")")}return new RegExp(u,p(n))}function l(t,e,n){return t instanceof RegExp?function(t,e){if(!e)return t;var n=t.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)e.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return t}(t,e):Array.isArray(t)?function(t,e,n){for(var r=[],o=0;o<t.length;o++)r.push(l(t[o],e,n).source);return new RegExp("(?:"+r.join("|")+")",p(n))}(t,e,n):function(t,e,n){return f(a(t,n),e,n)}(t,e,n)}function d(t){return Object.prototype.toString.call(t).indexOf("Error")>-1}function y(t,e,n){const r=t.charAt(0);if("/"===r)return t;if("?"===r||"#"===r)return e+t;const o=e.split("/");return n&&o[o.length-1]||o.pop(),t.replace(/^\//,"").split("/").forEach(t=>{".."===t?o.pop():"."!==t&&o.push(t)}),""!==o[0]&&o.unshift(""),o.join("/")}function m(t){return t.replace(/\/\//g,"/")}t.parse=e,t.compile=n,t.tokensToFunction=r,t.tokensToRegExp=o;const g=/[!'()*]/g,b=t=>"%"+t.charCodeAt(0).toString(16),v=/%2C/g,w=t=>encodeURIComponent(t).replace(g,b).replace(v,","),R=decodeURIComponent;function x(t){const e={};return(t=t.trim().replace(/^(\?|#|&)/,""))?(t.split("&").forEach(t=>{const n=t.replace(/\+/g," ").split("="),r=R(n.shift()||""),o=n.length>0?R(n.join("=")):null;void 0===e[r]?e[r]=o:Array.isArray(e[r])?e[r].push(o):e[r]=[e[r],o]}),e):e}function k(t){const e=t?Object.keys(t).map(e=>{const n=t[e];if(void 0===n)return"";if(null===n)return w(e);if(Array.isArray(n)){const t=[];return n.forEach(n=>{void 0!==n&&(null===n?t.push(w(e)):t.push(w(e)+"="+w(n)))}),t.join("&")}return w(e)+"="+w(n)}).filter(t=>t.length>0).join("&"):null;return e?`?${e}`:""}const E=/\/?$/;function O(t,e,n,r){const o=r&&r.options.stringifyQuery;let i=e.query||{};try{i=j(i)}catch(t){}const s={name:e.name||t&&t.name,meta:t&&t.meta||{},path:e.path||"/",hash:e.hash||"",query:i,params:e.params||{},fullPath:C(e,o),matched:t?A(t):[]};return n&&(s.redirectedFrom=C(n,o)),Object.freeze(s)}function j(t){if(Array.isArray(t))return t.map(j);if(t&&"object"==typeof t){const e={};return Object.keys(t).forEach(n=>{e[n]=j(t[n])}),e}return t}const T=O(void 0,{path:"/"});function A(t){const e=[];for(;t;)e.unshift(t),t=t.parent;return e}function C({path:t,query:e={},hash:n=""},r){return(t||"/")+(r||k)(e)+n}function _(t,e){return e===T?t===e:!!e&&(t.path&&e.path?t.path.replace(E,"")===e.path.replace(E,"")&&t.hash===e.hash&&L(t.query,e.query):!(!t.name||!e.name)&&(t.name===e.name&&t.hash===e.hash&&L(t.query,e.query)&&L(t.params,e.params)))}function L(t={},e={}){if(!t||!e)return t===e;const n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every(n=>{const r=t[n],o=e[n];return"object"==typeof r&&"object"==typeof o?L(r,o):String(r)===String(o)})}const U=Object.create(null);function $(e,n,r){n=n||{};try{const r=U[e]||(U[e]=t.compile(e));return n.pathMatch&&(n[0]=n.pathMatch),r(n,{pretty:!0})}catch(t){return""}finally{delete n[0]}}function q(t,e){return e&&Object.keys(e).forEach(n=>{t[n]=e[n]}),t}function M(t,e,n,r){let o="string"==typeof t?{path:t}:t;if(o._normalized)return o;if(o.name)return q({},t);if(!o.path&&o.params&&e){(o=q({},o))._normalized=!0;const t=q(q({},e.params),o.params);if(e.name)o.name=e.name,o.params=t;else if(e.matched.length){const n=e.matched[e.matched.length-1].path;o.path=$(n,t,e.path)}return o}const i=function(t){let e="",n="";const r=t.indexOf("#");r>=0&&(e=t.slice(r),t=t.slice(0,r));const o=t.indexOf("?");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{path:t,query:n,hash:e}}(o.path||""),s=e&&e.path||"/",a=i.path?y(i.path,s,n||o.append):s,c=function(t,e={},n){const r=n||x;let o;try{o=r(t||"")}catch(t){o={}}return Object.keys(e).forEach(t=>{o[t]=e[t]}),o}(i.query,o.query,r&&r.options.parseQuery);let h=o.hash||i.hash;return h&&"#"!==h.charAt(0)&&(h=`#${h}`),{_normalized:!0,path:a,query:c,hash:h}}function P(t,e){return new S(t,e)}class S{constructor(t,e){this.nameMap=Object.create(null),this.pathMap=Object.create(null),this.pathList=[],this.router=e,this.addRoutes(t),this.match=this.match.bind(this),this.addRoutes=this.addRoutes.bind(this)}addRoutes(t){t.forEach(t=>this.addRouteRecord(t)),this.wildcardToEnd()}match(t,e,n){const r=M(t,e,!1,this.router),{name:o}=r;if(o){const t=this.nameMap[o];if(!t)return this._createRoute(void 0,r);const i=t.keys.filter(t=>!t.optional).map(t=>t.name);if("object"!=typeof r.params&&(r.params={}),e&&"object"==typeof e.params)for(const t in e.params)!(t in r.params)&&i.indexOf(t)>-1&&(r.params[t]=e.params[t]);if(t)return r.path=$(t.path,r.params),this._createRoute(t,r,n)}else if(r.path){r.params={};for(let t=0;t<this.pathList.length;t++){const e=this.pathList[t],o=this.pathMap[e];if(F(o,r.path,r.params))return this._createRoute(o,r,n)}}return this._createRoute(void 0,r)}_createRoute(t,e,n){return t&&t.redirect?this.redirect(t,n||e):t&&t.matchAs?this.alias(t,e,t.matchAs):O(t,e,n,this.router)}redirect(t,e){const n=t.redirect;let r="function"==typeof n?n(O(t,e,void 0,this.router)):n;if("string"==typeof r&&(r={path:r}),!r||"object"!=typeof r)return this._createRoute(void 0,e);const o=r,{name:i,path:s}=o;let{query:a,hash:c,params:h}=e;if(a=o.hasOwnProperty("query")?o.query:a,c=o.hasOwnProperty("hash")?o.hash:c,h=o.hasOwnProperty("params")?o.params:h,i){this.nameMap[i];return this.match({_normalized:!0,name:i,query:a,hash:c,params:h},void 0,e)}if(s){const n=function(t,e){return y(t,e.parent?e.parent.path:"/",!0)}(s,t),r=$(n,h);return this.match({_normalized:!0,path:r,query:a,hash:c},void 0,e)}return this._createRoute(void 0,e)}alias(t,e,n){const r=$(n,e.params),o=this.match({_normalized:!0,path:r});if(o){const t=o.matched,n=t[t.length-1];return e.params=o.params,this._createRoute(n,e)}return this._createRoute(void 0,e)}addRouteRecord(e,n,r){const{path:o,name:i}=e,s=e.pathToRegexpOptions||{},a=function(t,e,n){return n||(t=t.replace(/\/$/,"")),"/"===t[0]?t:null==e?t:m(`${e.path}/${t}`)}(o,n,s.strict);"boolean"==typeof e.caseSensitive&&(s.sensitive=e.caseSensitive);const{keys:c,regex:h}=function(e,n){const r=[],o=t(e,r,n);return{keys:r,regex:o}}(a,s);let u;if("object"==typeof e.components)u=e.components;else if(e.component&&"function"==typeof e.component)u={default:e.component};else{if("object"!=typeof e.component)throw new Error("component or components must is class or object");u=e.component}const p={};Object.keys(u).forEach(t=>{"boolean"==typeof e.async?p[t]=e.async:"object"==typeof e.async?p[t]=e.async[t]||!1:p[t]=!1});const f={path:a,keys:c,regex:h,components:u,instances:{},name:i,parent:n,matchAs:r,redirect:e.redirect,beforeEnter:e.beforeEnter,meta:e.meta||{},props:null==e.props?{}:e.components?e.props:{default:e.props},async:p};if(e.children&&e.children.forEach(t=>{const e=r?m(`${r}/${t.path}`):void 0;this.addRouteRecord(t,f,e)}),void 0!==e.alias){(Array.isArray(e.alias)?e.alias:[e.alias]).forEach(t=>{const r={path:t,children:e.children,async:e.async};this.addRouteRecord(r,n,f.path||"/")})}this.pathMap[f.path]||(this.pathList.push(f.path),this.pathMap[f.path]=f),i&&(this.nameMap[i]||(this.nameMap[i]=f))}wildcardToEnd(){for(let t=0,e=this.pathList.length;t<e;t++)"*"===this.pathList[t]&&(this.pathList.push(this.pathList.splice(t,1)[0]),e--,t--)}}function F(t,e,n){const r=e.match(t.regex);if(!r)return!1;if(!n)return!0;for(let e=1,o=r.length;e<o;++e){const o=t.keys[e-1],i="string"==typeof r[e]?decodeURIComponent(r[e]):r[e];o&&(n[o.name||"pathMatch"]=i)}return!0}const H="undefined"!=typeof window,W=Object.create(null);function z(){window.history.replaceState({key:J()},"",window.location.href.replace(window.location.origin,"")),window.addEventListener("popstate",t=>{I(),t.state&&t.state.key&&function(t){Y=t}(t.state.key)})}function B(t,e,n,r){if(!t.app)return;const o=t.options.scrollBehavior;o&&t.app.$nextTick(()=>{const i=function(){const t=J();if(t)return W[t]}(),s=o.call(t,e,n,r?i:void 0);s&&("function"==typeof s.then?s.then(t=>{V(t,i)}).catch(t=>{}):V(s,i))})}function I(){const t=J();t&&(W[t]={x:window.pageXOffset,y:window.pageYOffset})}function N(t){return K(t.x)||K(t.y)}function D(t){return{x:K(t.x)?t.x:window.pageXOffset,y:K(t.y)?t.y:window.pageYOffset}}function K(t){return"number"==typeof t}function V(t,e){const n="object"==typeof t;if(n&&"string"==typeof t.selector){const n=document.querySelector(t.selector);if(n){let o=t.offset&&"object"==typeof t.offset?t.offset:{};e=function(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{x:r.left-n.left-e.x,y:r.top-n.top-e.y}}(n,o={x:K((r=o).x)?r.x:0,y:K(r.y)?r.y:0})}else N(t)&&(e=D(t))}else n&&N(t)&&(e=D(t));var r;e&&window.scrollTo(e.x,e.y)}const Q=H&&(()=>{const t=window.navigator.userAgent;return(-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)})(),X=H&&window.performance&&window.performance.now?window.performance:Date;let Y=G();function G(){return X.now().toFixed(3)}function J(){return Y}function Z(t,e){I();const n=window.history;try{e?n.replaceState({key:Y},"",t):(Y=G(),n.pushState({key:Y},"",t))}catch(n){window.location[e?"replace":"assign"](t||"")}}function tt(t){Z(t,!0)}function et(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}var nt=(t,{Component:e,createElement:n,cloneElement:r,PropTypes:o})=>{function i(){return e.apply(this,arguments)||this}return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.__proto__=e,i.prototype.render=function(){var e=this.props,o=e.tag,i=e.href,s=void 0===i?"/":i,a=e.to,c=void 0===a?s:a,h=e.event,u=void 0===h?[]:h,p=e.children,f=et(e,["tag","href","to","event","children"]),l=t.currentRoute,d=t.resolve(c,l,f.append),y=d.location,m=d.route,g=d.href,b={},v=t.options.linkActiveClass,w=t.options.linkExactActiveClass,R=null==v?"router-link-active":v,x=null==w?"router-link-exact-active":w,k=null==f.activeClass?R:f.activeClass,j=null==f.exactActiveClass?x:f.exactActiveClass,T=y.path?O(null,y,null,t):m;b[j]=_(l,T),b[k]=f.exact?b[j]:function(t,e){return 0===t.path.replace(E,"/").indexOf(e.path.replace(E,"/"))&&(!e.hash||t.hash===e.hash)&&function(t,e){for(const n in e)if(!(n in t))return!1;return!0}(t.query,e.query)}(l,T);var A=function(e){rt(e)&&(f.replace?t.replace(y):t.push(y))};f.className=Object.keys(b).filter(function(t){return b[t]}).join(" "),f.className||delete f.className;var C={onClick:rt};Array.isArray(u)?u.forEach(function(t){C[t]=A}):C[u]=A,f.href=g;var L=p;if("a"===o)Object.assign(f,C),f.href=g;else{var U=function t(e,n,r,o=!1){if(!o&&e)if(Array.isArray(e))e=e.map(e=>{const i=t(e,n,r,o);return o=i.isFinded,i.children});else if("a"===e.type)e=r(e),o=!0;else if(e.props&&e.props.children){const{children:i,...s}=e.props,a=t(i,n,r,o);n?e=n(e,s,a.children):e.children=a.children,o=a.isFinded}return{isFinded:o,children:e}}(p,r,function(t){if(r){var e=t.props,n=e.children,o=et(e,["children"]);return r(t,Object.assign(o,C,{href:g}),[n])}return Object.assign(t.props,C,{href:g}),t});L=U.children,U.isFinded||Object.assign(f,C)}return n(o,f,L)},Object.assign(i,{defaultProps:{tag:"a",event:"onClick"},propTypes:{to:o.oneOfType([o.string.isRequired,o.object.isRequired]),tag:o.string,exact:o.bool,append:o.bool,replace:o.bool,activeClass:o.string,exactActiveClass:o.string,event:o.oneOfType([o.string,o.arrayOf(o.string)])}}),i};function rt(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||t.defaultPrevented||void 0!==t.button&&0!==t.button)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}var ot=(t,{Component:e,createElement:n,PropTypes:r})=>{function o(){for(var n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=e.call.apply(e,[this].concat(o))||this).offForceUpdate=t.afterEach(function(){return n.forceUpdate&&n.forceUpdate()}),n}o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.__proto__=e;var i=o.prototype;return i.render=function(){var e=this._routerViewCache||(this._routerViewCache={}),r=this.props,o=r.name,i=r.children,s=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(r,["name","children"]),a=t.currentRoute;s.route=a,s.router=t;var c=a.matched[0];if(!c)return e[o]=null,n("div",s,"\u6ca1\u6709");var h=e[o]=function(t){function e(){return t.apply(this,arguments)||this}e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t;var n=e.prototype;return n.componentWillMount=function(){if(c.instances[o]=this,t.prototype.componentWillMount)return t.prototype.componentWillMount.call(this)},n.componentWillUnmount=function(){if(c.instances[o]===this&&(c.instances[o]=void 0),t.prototype.componentWillUnmount)return t.prototype.componentWillUnmount.call(this)},e}(c.components[o]),u=function(t,e){switch(typeof e){case"undefined":return;case"object":return e;case"function":return e(t);case"boolean":return e?t.params:void 0}}(a,c.props&&c.props[o]);return u&&Object.assign(s,u),n(h,s,i)},i.componentWillUnmount=function(){this.offForceUpdate&&(this.offForceUpdate(),this.offForceUpdate=void 0)},Object.assign(o,{defaultProps:{name:"default"},propTypes:{name:r.string}}),o};const it=(t,e,n)=>{const r=o=>{o>=t.length?n():t[o]?e(t[o],()=>{r(o+1)}):r(o+1)};r(0)};function st(t){return(e,n,r)=>{let o=!1,i=0,s=null;at(t,(t,e,n,a)=>{if("function"==typeof t&&!0===n.async[a]){o=!0,i++;const e=ut(t=>{(function(t){return t.__esModule||ht&&"Module"===t[Symbol.toStringTag]})(t)&&(t=t.default),n.async[a]=!1,n.components[a]=t,--i<=0&&r()}),c=ut(t=>{const e=`Failed to resolve async component ${a}: ${t}`;s||(s=d(t)?t:new Error(e),r(s))});let h;try{h=t(e,c)}catch(t){c(t)}if(h)if("function"==typeof h.then)h.then(e,c);else{const t=h.component;t&&"function"==typeof t.then&&t.then(e,c)}}}),o||r()}}function at(t,e){return ct(t.map(t=>Object.keys(t.components).map(n=>e(t.components[n],t.instances[n],t,n))))}function ct(t){return Array.prototype.concat.apply([],t)}const ht="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;function ut(t){let e=!1;return function(...n){if(!e)return e=!0,t.apply(this,n)}}class pt{constructor(t,e){this.router=t,this.base=function(t){if(!t)if(H){const e=document.querySelector("base");t=(t=e&&e.getAttribute("href")||"/").replace(/^https?:\/\/[^\/]+/,"")}else t="/";"/"!==t.charAt(0)&&(t="/"+t);return t.replace(/\/$/,"")}(e),this.router.currentRoute=T,this.pending=void 0,this.ready=!1,this.readyCbs=[],this.readyErrorCbs=[],this.errorCbs=[],this.cb=(()=>void 0)}init(){}listen(t){this.cb=t}onReady(t,e){this.ready?t():(this.readyCbs.push(t),e&&this.readyErrorCbs.push(e))}onError(t){this.errorCbs.push(t)}transitionTo(t,e,n){const r=this.router.match(t,this.router.currentRoute);this.confirmTransition(r,()=>{this.updateRoute(r),"function"==typeof e&&e(r),this.ensureURL(),this.ready||(this.ready=!0,this.readyCbs.forEach(t=>{t(r)}))},t=>{n&&n(t),t&&!this.ready&&(this.ready=!0,this.readyErrorCbs.forEach(e=>{e(t)}))})}confirmTransition(t,e,n){const r=this.router.currentRoute,o=t=>{t&&d(t)&&(this.errorCbs.length?this.errorCbs.forEach(e=>{e(t)}):console&&console.error(t)),"function"==typeof n&&n(t)};if(_(t,r)&&t.matched.length===r.matched.length)return this.ensureURL(),o();const{updated:i,deactivated:s,activated:a}=function(t,e){let n;const r=Math.max(t.length,e.length);for(n=0;n<r&&t[n]===e[n];n++);return{updated:e.slice(0,n),activated:e.slice(n),deactivated:t.slice(n)}}(this.router.currentRoute.matched,t.matched),c=[].concat(function(t){return ft(t,"beforeRouteLeave",lt,!0)}(s),this.router.beforeHooks,function(t){return ft(t,"beforeRouteUpdate",lt)}(i),a.map(t=>t.beforeEnter),st(a));this.pending=t;const h=(e,n)=>{if(this.pending!==t)return o();try{e(t,r,t=>{!1===t||d(t)?(this.ensureURL(!0),o(t)):"string"==typeof t||"object"==typeof t&&("string"==typeof t.path||"string"==typeof t.name)?(o(),"object"==typeof t&&t.replace?this.replace(t):this.push(t)):n(t)})}catch(t){o(t)}};it(c,h,()=>{const n=[],r=function(t,e,n){return ft(t,"beforeRouteEnter",(t,r,o,i)=>(function(t,e,n,r,o){return function(i,s,a){return t(i,s,t=>{a(t),"function"==typeof t&&r.push(()=>{!function t(e,n,r,o){n[r]&&!n[r]._isBeingDestroyed?e(n[r]):o()&&setTimeout(()=>{t(e,n,r,o)},16)}(t,e.instances,n,o)})})}})(t,o,i,e,n))}(a,n,()=>this.router.currentRoute===t).concat(this.router.resolveHooks);it(r,h,()=>{if(this.pending!==t)return o();this.pending=void 0,e(t),this.router.app&&this.router.app.$nextTick(()=>{n.forEach(t=>{t()})})})})}updateRoute(t){const e=this.router.currentRoute;this.router.currentRoute=t,this.cb&&this.cb(t),this.router.afterHooks.forEach(n=>n&&n(t,e))}}function ft(t,e,n,r){const o=at(t,(t,r,o,i)=>{const s=t.prototype&&t.prototype[e];if(s)return n(s,r,o,i)});return ct(r?o.reverse():o)}function lt(t,e){if(e)return t.bind(e)}class dt extends pt{constructor(t,e){super(t,e);const n=t.options.scrollBehavior,r=Q&&n;r&&z();const o=yt(this.base);window.addEventListener("popstate",e=>{const n=this.router.currentRoute,i=yt(this.base);this.router.currentRoute===T&&i===o||this.transitionTo(i,e=>{r&&B(t,e,n,!0)})})}init(){this.transitionTo(this.getCurrentLocation())}go(t){window.history.go(t)}push(t,e,n){const r=this.router.currentRoute;this.transitionTo(t,t=>{Z(m(this.base+t.fullPath)),B(this.router,t,r,!1),"function"==typeof e&&e(t)},n)}replace(t,e,n){const r=this.router.currentRoute;this.transitionTo(t,t=>{tt(m(this.base+t.fullPath)),B(this.router,t,r,!1),"function"==typeof e&&e(t)},n)}ensureURL(t){if(yt(this.base)!==this.router.currentRoute.fullPath){const e=m(this.base+this.router.currentRoute.fullPath);t?Z(e):tt(e)}}getCurrentLocation(){return yt(this.base)}}function yt(t){let e=decodeURI(window.location.pathname);return t&&0===e.indexOf(t)&&(e=e.slice(t.length)),(e||"/")+window.location.search+window.location.hash}class mt extends pt{constructor(t,e,n=!1){super(t,e),n&&function(t){const e=yt(t);if(!/^\/#/.test(e))return window.location.replace(m(t+"/#"+e)),!0}(this.base)||gt()}init(){const t=()=>{this.setupListeners()};this.transitionTo(this.getCurrentLocation(),t,t)}setupListeners(){const t=this.router.options.scrollBehavior,e=Q&&t;e&&z(),window.addEventListener(Q?"popstate":"hashchange",()=>{const t=this.router.currentRoute;gt()&&this.transitionTo(bt(),n=>{e&&B(this.router,n,t,!0),Q||Rt(n.fullPath)})})}push(t,e,n){const r=this.router.currentRoute;this.transitionTo(t,t=>{wt(t.fullPath),B(this.router,t,r,!1),"function"==typeof e&&e(t)},n)}replace(t,e,n){const r=this.router.currentRoute;this.transitionTo(t,t=>{Rt(t.fullPath),B(this.router,t,r,!1),"function"==typeof e&&e(t)},n)}go(t){window.history.go(t)}ensureURL(t){const e=this.router.currentRoute.fullPath;bt()!==e&&(t?wt(e):Rt(e))}getCurrentLocation(){return bt()}}function gt(){const t=bt();return"/"===t.charAt(0)||(Rt("/"+t),!1)}function bt(){const t=window.location.href,e=t.indexOf("#");return-1===e?"":decodeURI(t.slice(e+1))}function vt(t){const e=window.location.href,n=e.indexOf("#");return`${n>=0?e.slice(0,n):e}#${t}`}function wt(t){Q?Z(vt(t)):window.location.hash=t}function Rt(t){Q?tt(vt(t)):window.location.replace(vt(t))}class xt extends pt{constructor(t,e){super(t,e),this.stack=[],this.index=-1}push(t,e,n){this.transitionTo(t,t=>{this.stack=this.stack.slice(0,this.index+1).concat(t),this.index++,"function"==typeof e&&e(t)},n)}replace(t,e,n){this.transitionTo(t,t=>{this.stack=this.stack.slice(0,this.index).concat(t),"function"==typeof e&&e(t)},n)}go(t){const e=this.index+t;if(e<0||e>=this.stack.length)return;const n=this.stack[e];this.confirmTransition(n,()=>{this.index=e,this.updateRoute(n)})}getCurrentLocation(){const t=this.stack[this.stack.length-1];return t?t.fullPath:"/"}ensureURL(){}}const kt=!1;class Et{constructor(t){let e;switch(this.options=t||{},this.beforeHooks=[],this.resolveHooks=[],this.afterHooks=[],this.currentRoute=T,"function"==typeof this.options.match?this.match=this.options.match:!1!==this.options.routes&&(this.matcher=P(this.options.routes||[],this)),this.getLink=(t=>nt(this,t)),this.getView=(t=>ot(this,t)),this.fallback="history"===this.options.mode&&!Q&&!1!==this.options.fallback,this.options.mode?e=this.options.mode:H&&(e=this.options.mode||"history",this.fallback&&(e="hash")),kt?e="weex":H||(e="abstract"),this.mode=e||"abstract",this.mode){case"history":this.history=new dt(this,this.options.base);break;case"hash":this.history=new mt(this,this.options.base,this.fallback);break;case"abstract":this.history=new xt(this,this.options.base);break;default:this.history=new xt(this,this.options.base)}}withRouter(){}init(){"function"==typeof this.history.init&&this.history.init()}beforeEach(t){return Ot(this.beforeHooks,t)}beforeResolve(t){return Ot(this.resolveHooks,t)}afterEach(t){return Ot(this.afterHooks,t)}onReady(t,e){this.history.onReady(t,e)}onError(t){this.history.onError(t)}push(t,e,n){this.history.push(t,e,n)}replace(t,e,n){this.history.replace(t,e,n)}go(t){this.history.go(t)}back(){this.go(-1)}forward(){this.go(1)}getMatchedComponents(t){const e=t?t.matched?t:this.resolve(t).route:this.currentRoute;return e?[].concat.apply([],e.matched.map(t=>Object.keys(t.components).map(e=>t.components[e]))):[]}resolve(t,e,n){const r=M(t,e=e||this.currentRoute,n,this),o=this.match(r,e),i=o.redirectedFrom||o.fullPath;return{location:r,route:o,href:function(t,e,n){const r="hash"===n?"#"+e:e;return t?m(t+"/"+r):r}(this.history.base,i,this.mode),normalizedTo:r,resolved:o}}match(t,e,n){if(!this.matcher)throw new Error("No matcher instance");return this.matcher.match(t,e,n)}addRoutes(t){if(!this.matcher)throw new Error("No matcher instance");this.matcher.addRoutes(t),this.currentRoute!==T&&this.history.transitionTo(this.history.getCurrentLocation())}}function Ot(t,e){return Array.isArray(t)?(t.push(e),()=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)}):()=>{}}const jt=(t={})=>new Et(t);export default Et;export{P as createMatcher,S as Matcher,Et as Router,jt as getRouter};